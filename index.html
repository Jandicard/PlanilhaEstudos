<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planilha de Estudos - Concurso Joinville</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        // Cole aqui todo o c√≥digo React da primeira vers√£o (o componente StudyTracker)
        // Come√ßando com: const StudyTracker = () => { ...
        
        const StudyTracker = () => {
          const [dailyProgress, setDailyProgress] = useState(() => {
            const saved = localStorage.getItem('studyProgress');
            return saved ? JSON.parse(saved) : {};
          });

          const [currentPhase, setCurrentPhase] = useState(1);
          const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);

          useEffect(() => {
            localStorage.setItem('studyProgress', JSON.stringify(dailyProgress));
          }, [dailyProgress]);

          const phases = {
            1: {
              name: "Fase 1: Base e Revis√£o",
              period: "01/10 a 28/10",
              days: 28,
              daily: {
                "Conhecimentos Espec√≠ficos": 5,
                "Inform√°tica B√°sica": 2,
                "Pol√≠ticas e Legisla√ß√µes": 2,
                "Portugu√™s": 2,
                "Matem√°tica": 1
              }
            },
            2: {
              name: "Fase 2: Intensifica√ß√£o",
              period: "29/10 a 25/11",
              days: 28,
              daily: {
                "Conhecimentos Espec√≠ficos": 6,
                "Inform√°tica B√°sica": 2,
                "Pol√≠ticas e Legisla√ß√µes": 2,
                "Portugu√™s": 1,
                "Matem√°tica": 1
              }
            },
            3: {
              name: "Fase 3: Revis√£o e Simulados",
              period: "26/11 a 06/12",
              days: 21,
              daily: {
                "Conhecimentos Espec√≠ficos": 6,
                "Inform√°tica B√°sica": 2,
                "Pol√≠ticas e Legisla√ß√µes": 2,
                "Portugu√™s": 1,
                "Matem√°tica": 1
              },
              weekend: {
                "Simulado Completo": 50
              }
            }
          };

          const subjects = [
            "Conhecimentos Espec√≠ficos",
            "Inform√°tica B√°sica",
            "Pol√≠ticas e Legisla√ß√µes",
            "Portugu√™s",
            "Matem√°tica"
          ];

          const handleQuestionUpdate = (date, subject, value) => {
            setDailyProgress(prev => ({
              ...prev,
              [date]: {
                ...prev[date],
                [subject]: parseInt(value) || 0
              }
            }));
          };

          const handleSimuladoToggle = (date) => {
            setDailyProgress(prev => ({
              ...prev,
              [date]: {
                ...prev[date],
                simulado: !prev[date]?.simulado
              }
            }));
          };

          const getTodayProgress = () => {
            const today = dailyProgress[selectedDate] || {};
            const phase = phases[currentPhase];
            let total = 0;
            let completed = 0;

            Object.keys(phase.daily).forEach(subject => {
              total += phase.daily[subject];
              completed += today[subject] || 0;
            });

            return { completed, total, percentage: total > 0 ? (completed / total * 100).toFixed(0) : 0 };
          };

          const getOverallStats = () => {
            let stats = {};
            subjects.forEach(subject => {
              stats[subject] = 0;
            });
            stats.simulados = 0;

            Object.keys(dailyProgress).forEach(date => {
              const day = dailyProgress[date];
              subjects.forEach(subject => {
                stats[subject] += day[subject] || 0;
              });
              if (day.simulado) {
                stats.simulados += 1;
              }
            });

            return stats;
          };

          const progress = getTodayProgress();
          const stats = getOverallStats();
          const phase = phases[currentPhase];
          const isWeekend = new Date(selectedDate).getDay() === 0 || new Date(selectedDate).getDay() === 6;

          return (
            <div className="min-h-screen bg-gradient-to-br from-teal-50 to-blue-50 p-6">
              <div className="max-w-6xl mx-auto">
                {/* Header */}
                <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                  <div className="flex items-center justify-between mb-4">
                    <div>
                      <h1 className="text-3xl font-bold text-teal-700 flex items-center gap-2">
                        üéØ Concurso Prefeitura de Joinville
                      </h1>
                      <p className="text-gray-600 mt-1">Analista de Sistema de Informa√ß√£o</p>
                    </div>
                    <div className="text-right">
                      <div className="text-2xl font-bold text-teal-600">07/12/2025</div>
                      <div className="text-sm text-gray-500">Data da Prova</div>
                    </div>
                  </div>
                  
                  {/* Phase Selector */}
                  <div className="flex gap-2 mb-4">
                    {[1, 2, 3].map(p => (
                      <button
                        key={p}
                        onClick={() => setCurrentPhase(p)}
                        className={`flex-1 py-3 px-4 rounded-lg font-semibold transition ${
                          currentPhase === p
                            ? 'bg-teal-600 text-white'
                            : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                        }`}
                      >
                        Fase {p}
                      </button>
                    ))}
                  </div>

                  <div className="bg-teal-50 p-4 rounded-lg">
                    <div className="font-semibold text-teal-700">{phase.name}</div>
                    <div className="text-sm text-teal-600">{phase.period} ‚Ä¢ {phase.days} dias</div>
                  </div>
                </div>

                <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                  {/* Daily Tracker */}
                  <div className="lg:col-span-2 bg-white rounded-lg shadow-lg p-6">
                    <div className="flex items-center justify-between mb-6">
                      <h2 className="text-xl font-bold text-gray-800 flex items-center gap-2">
                        üìÖ Registro Di√°rio
                      </h2>
                      <input
                        type="date"
                        value={selectedDate}
                        onChange={(e) => setSelectedDate(e.target.value)}
                        className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"
                      />
                    </div>

                    {/* Progress Bar */}
                    <div className="mb-6">
                      <div className="flex justify-between text-sm mb-2">
                        <span className="font-semibold text-gray-700">Progresso do Dia</span>
                        <span className="text-teal-600 font-bold">{progress.completed}/{progress.total} quest√µes</span>
                      </div>
                      <div className="w-full bg-gray-200 rounded-full h-4">
                        <div
                          className="bg-gradient-to-r from-teal-500 to-blue-500 h-4 rounded-full transition-all duration-300"
                          style={{ width: `${progress.percentage}%` }}
                        />
                      </div>
                      <div className="text-right text-sm text-gray-600 mt-1">{progress.percentage}%</div>
                    </div>

                    {/* Questions Input */}
                    <div className="space-y-4">
                      {subjects.map(subject => (
                        <div key={subject} className="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition">
                          <div className="flex-1">
                            <div className="font-semibold text-gray-700">{subject}</div>
                            <div className="text-sm text-gray-500">Meta: {phase.daily[subject]} quest√µes</div>
                          </div>
                          <input
                            type="number"
                            min="0"
                            value={dailyProgress[selectedDate]?.[subject] || ''}
                            onChange={(e) => handleQuestionUpdate(selectedDate, subject, e.target.value)}
                            placeholder="0"
                            className="w-20 px-3 py-2 border border-gray-300 rounded-lg text-center text-lg font-semibold focus:ring-2 focus:ring-teal-500 focus:border-transparent"
                          />
                        </div>
                      ))}

                      {/* Simulado Toggle for Phase 3 weekends */}
                      {currentPhase === 3 && isWeekend && (
                        <div className="p-4 bg-yellow-50 border-2 border-yellow-200 rounded-lg">
                          <div className="flex items-center justify-between">
                            <div>
                              <div className="font-bold text-yellow-800 flex items-center gap-2">
                                üèÜ Simulado Completo
                              </div>
                              <div className="text-sm text-yellow-700">50 quest√µes no formato da prova</div>
                            </div>
                            <button
                              onClick={() => handleSimuladoToggle(selectedDate)}
                              className={`px-6 py-3 rounded-lg font-semibold transition ${
                                dailyProgress[selectedDate]?.simulado
                                  ? 'bg-yellow-600 text-white'
                                  : 'bg-white text-yellow-600 border-2 border-yellow-600'
                              }`}
                            >
                              {dailyProgress[selectedDate]?.simulado ? 'Conclu√≠do ‚úì' : 'Marcar'}
                            </button>
                          </div>
                        </div>
                      )}
                    </div>
                  </div>

                  {/* Statistics Panel */}
                  <div className="bg-white rounded-lg shadow-lg p-6">
                    <h2 className="text-xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                      üìà Estat√≠sticas Gerais
                    </h2>

                    <div className="space-y-4">
                      {subjects.map(subject => (
                        <div key={subject} className="border-b border-gray-200 pb-3">
                          <div className="text-sm font-semibold text-gray-600 mb-1">{subject}</div>
                          <div className="text-2xl font-bold text-teal-600">{stats[subject]}</div>
                          <div className="text-xs text-gray-500">quest√µes resolvidas</div>
                        </div>
                      ))}

                      <div className="bg-gradient-to-r from-yellow-50 to-orange-50 p-4 rounded-lg border border-yellow-200">
                        <div className="text-sm font-semibold text-yellow-800 mb-1">Simulados Completos</div>
                        <div className="text-3xl font-bold text-yellow-700">{stats.simulados}</div>
                        <div className="text-xs text-yellow-600">realizados</div>
                      </div>

                      <div className="bg-gradient-to-r from-teal-50 to-blue-50 p-4 rounded-lg border border-teal-200 mt-6">
                        <div className="text-sm font-semibold text-teal-800 mb-1">Total Geral</div>
                        <div className="text-3xl font-bold text-teal-700">
                          {Object.values(stats).reduce((a, b) => a + (typeof b === 'number' ? b : 0), 0) - stats.simulados}
                        </div>
                        <div className="text-xs text-teal-600">quest√µes + {stats.simulados * 50} em simulados</div>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Meta por Fase */}
                <div className="bg-white rounded-lg shadow-lg p-6 mt-6">
                  <h2 className="text-xl font-bold text-gray-800 mb-4">Meta Di√°ria - {phase.name}</h2>
                  <div className="grid grid-cols-2 md:grid-cols-5 gap-4">
                    {Object.entries(phase.daily).map(([subject, count]) => (
                      <div key={subject} className="text-center p-4 bg-teal-50 rounded-lg">
                        <div className="text-3xl font-bold text-teal-600">{count}</div>
                        <div className="text-sm text-gray-600 mt-1">{subject}</div>
                      </div>
                    ))}
                  </div>
                  {currentPhase === 3 && (
                    <div className="mt-4 p-4 bg-yellow-50 rounded-lg text-center">
                      <div className="text-sm font-semibold text-yellow-800">Finais de Semana (Fase 3)</div>
                      <div className="text-2xl font-bold text-yellow-700 mt-1">1 Simulado Completo (50 quest√µes)</div>
                    </div>
                  )}
                </div>
              </div>
            </div>
          );
        };

        // Renderizar o componente
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<StudyTracker />);
    </script>
</body>
</html>